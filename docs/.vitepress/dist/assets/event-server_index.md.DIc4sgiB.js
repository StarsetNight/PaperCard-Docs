import{_ as s,c as a,o as i,a3 as t}from"./chunks/framework.BYhES31N.js";const u=JSON.parse('{"title":"PaperCard事件服务器","description":"","frontmatter":{},"headers":[],"relativePath":"event-server/index.md","filePath":"event-server/index.md","lastUpdated":null}'),n={name:"event-server/index.md"},e=t(`<h1 id="papercard事件服务器" tabindex="-1">PaperCard事件服务器 <a class="header-anchor" href="#papercard事件服务器" aria-label="Permalink to &quot;PaperCard事件服务器&quot;">​</a></h1><p>---- 基于<code>WebSocket</code>技术实现实时事件推送</p><h2 id="意义" tabindex="-1">意义 <a class="header-anchor" href="#意义" aria-label="Permalink to &quot;意义&quot;">​</a></h2><p>为了实现：实时地多端消息互通。如在<strong>网页</strong>上封禁了一个玩家，要将该事件发布出去，MC服接收到此事件后作出响应踢出相关玩家。</p><h2 id="连接地址" tabindex="-1">连接地址 <a class="header-anchor" href="#连接地址" aria-label="Permalink to &quot;连接地址&quot;">​</a></h2><p><code>ws://paper-card.cn/event</code></p><h2 id="连接认证" tabindex="-1">连接认证 <a class="header-anchor" href="#连接认证" aria-label="Permalink to &quot;连接认证&quot;">​</a></h2><p>只有授权的客户端（主要为MC服）才能连接到事件服务器，来接收事件进行处理，或者发布事件。</p><p>客户端提供客户端ID、密钥HASH等信息进行认证。</p><h2 id="发布的事件消息格式" tabindex="-1">发布的事件消息格式 <a class="header-anchor" href="#发布的事件消息格式" aria-label="Permalink to &quot;发布的事件消息格式&quot;">​</a></h2><p>基本格式：</p><div class="language-json5 vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json5</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;事件名称&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;client_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;发布事件的客户端ID&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ... 其他参数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>假设一个玩家进入MC服务器事件：</p><div class="language-json5 vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json5</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;player.join.server&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;client_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;发布事件的客户端ID&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;玩家游戏名&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;玩家游戏ID&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 秒级时间戳</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;online&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 在线玩家数量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><a href="./events.html">查看所有事件类型</a></p><h2 id="事件发布" tabindex="-1">事件发布 <a class="header-anchor" href="#事件发布" aria-label="Permalink to &quot;事件发布&quot;">​</a></h2><p>连接到事件服务器的客户端通过发送JSON消息来发布事件，事件服务器不检查消息格式，只会将事件广播给其它客户端。</p><p>消息格式与发布事件的基本相同，但是不需要提供<code>client_id</code>，事件服务器能够识别哪个客户端发布事件。</p>`,18),h=[e];function p(l,k,r,d,o,E){return i(),a("div",null,h)}const g=s(n,[["render",p]]);export{u as __pageData,g as default};
